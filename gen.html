<!doctype html>

<html>
    <head>
        <meta charset="utf-8">
        
        <title>v0</title>

        <!-- Scripts -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/threejs/r84/three.min.js"></script>
        <script src="https://rawgithub.com/jwagner/simplex-noise.js/master/simplex-noise.js"></script>
        
        <style>
            body{
                margin: 0;
                overflow: hidden;
            }
        </style>
    </head>
    
    <body>
        
        <script>
            var dim = 120; // Make divisible by three?
            var matrixX = dim, matrixY = dim;
            
            var noiseDensity = 0.01;
            
            var t = 0;
            
            var simplexX, simplexY, simplexZ;
            var scene, camera, renderer;
            
            function initNoise(){
                // Seed the simplex noise generators
                simplexX = new SimplexNoise('seedX');
                simplexY = new SimplexNoise('seedY');
                simplexZ = new SimplexNoise('seedZ');
            }
            
            function initialize(){
                initNoise();

                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                renderer = new THREE.WebGLRenderer();
                
                renderer.setSize(window.innerWidth, window.innerHeight);
                document.body.appendChild(renderer.domElement);
            }
            
            function initVertices(){                
                for(var x = 0; x < matrixX; x++){
                    for(var y = 0; y < matrixY; y++){
                        for(var z = 0; z < 3; z++){
                            vertArray.push(0);
                        }                        
                    }
                }                
            }
            
            function updateVerts(){
                var positions = mesh.geometry.attributes.position.array;
                
                for(var x = 0; x < matrixX; x++){
                    for(var y = 0; y < matrixY; y++){
                        var posX = simplexX.noise3D(x * noiseDensity, y * noiseDensity, t);
                        var posY = simplexY.noise3D(x * noiseDensity, y * noiseDensity, t);
                        var posZ = simplexZ.noise3D(x * noiseDensity, y * noiseDensity, t);
                        
                        positions[(x + y * matrixX) * 3 + 0] = posX;
                        positions[(x + y * matrixY) * 3 + 1] = posY;
                        positions[(x + y * matrixX) * 3 + 2] = posZ;                      
                    }                    
                }
                t+=0.002;
                
                mesh.geometry.attributes.position.needsUpdate = true;
            }
            
            var vertArray = [];
            
            initialize();
            
            initVertices();
            
            var vertices = new Float32Array(vertArray);
            
            var geometry = new THREE.BufferGeometry();
            geometry.addAttribute('position', new THREE.BufferAttribute(vertices, 3));
            geometry.dynamic = true;
            
            var material = new THREE.MeshBasicMaterial({color: 0xffffff, wireframe: true});
            
            var mesh = new THREE.Mesh(geometry, material);
            scene.add(mesh);
            
            camera.position.z = 2;
            
            function animate(){
                requestAnimationFrame(animate);
                
                updateVerts();               
                renderer.render(scene, camera);
            }
            
            animate();
            
        </script>
        
    </body>
</html>